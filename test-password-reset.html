<!DOCTYPE html>
<html>
<head>
  <title>Test Password Reset</title>
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body>
  <h1>Test Password Reset</h1>
  <input type="email" id="email" placeholder="Enter email" value="test@example.com">
  <button onclick="testReset()">Test Reset</button>
  <div id="result"></div>
  
  <script>
    const supabase = window.supabase.createClient(
      'https://birthcsvtmayyxrzzyhh.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJpcnRoY3N2dG1heXl4cnp6eWhoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgzNzU2MjgsImV4cCI6MjA3Mzk1MTYyOH0.rqvnSSt5as1JBiqqEH02ktTwfdUvqp7armaImUizFfA'
    );
    
    async function testReset() {
      const email = document.getElementById('email').value;
      const resultDiv = document.getElementById('result');
      
      try {
        resultDiv.innerHTML = 'Sending...';
        
        // Test 1: Without redirect URL
        const { data: data1, error: error1 } = await supabase.auth.resetPasswordForEmail(email);
        console.log('Test 1 (no redirect):', { data: data1, error: error1 });
        
        if (error1) {
          resultDiv.innerHTML += '<br>Test 1 Error: ' + error1.message;
        } else {
          resultDiv.innerHTML += '<br>Test 1 Success!';
        }
        
        // Test 2: With redirect URL
        const { data: data2, error: error2 } = await supabase.auth.resetPasswordForEmail(email, {
          redirectTo: 'https://diamondplusportal.com/auth/confirm?flow=recovery'
        });
        console.log('Test 2 (with redirect):', { data: data2, error: error2 });
        
        if (error2) {
          resultDiv.innerHTML += '<br>Test 2 Error: ' + error2.message;
        } else {
          resultDiv.innerHTML += '<br>Test 2 Success!';
        }
        
      } catch (err) {
        console.error('Caught error:', err);
        resultDiv.innerHTML = 'Error: ' + err.message;
      }
    }
  </script>
</body>
</html>
